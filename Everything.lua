img={}
p={}
images={
	wizard={
		normal={
			right={
				{"15950cb5244",-38.5,-33},
				{"15950cc4277",-38.5,-33},
				{"15950cd2d1f",-38.5,-33},
				{"15950ce2a35",-38.5,-33},
				{"15950ce52fd",-38.5,-33},
				{"15950ce67ee",-38.5,-33},
				{"15950ce7b26",-38.5,-33},
				{"15950ce8e78",-38.5,-33},
				{"15950cea22a",-38.5,-33},
				{"15950cb69b4",-38.5,-33},
				{"15950cb7ce0",-38.5,-33},
				{"15950cb90f1",-38.5,-33},
				{"15950cba609",-38.5,-33},
				{"15950cbba03",-38.5,-33},
				{"15950cbce29",-38.5,-33},
				{"15950cbe77b",-38.5,-33},
				{"15950cbfc97",-38.5,-33},
				{"15950cc1487",-38.5,-33},
				{"15950cc2b1d",-38.5,-33},
				{"15950cc55d7",-38.5,-33},
				{"15950cc6db5",-38.5,-33},
				{"15950cc840e",-38.5,-33},
				{"15950cc9a70",-38.5,-33},
				{"15950ccb040",-38.5,-33},
				{"15950ccc5c9",-38.5,-33},
				{"15950ccd9af",-38.5,-33},
				{"15950ccef27",-38.5,-33},
				{"15950cd034f",-38.5,-33},
				{"15950cd19a4",-38.5,-33},
				{"15950cd47cc",-38.5,-33},
				{"15950cd5c0f",-38.5,-33},
				{"15950cd6ec3",-38.5,-33},
				{"15950cd84b4",-38.5,-33},
				{"15950cd9b65",-38.5,-33},
				{"15950cdb108",-38.5,-33},
				{"15950cdc6ac",-38.5,-33},
				{"15950cddb5f",-38.5,-33},
				{"15950cdef8c",-38.5,-33},
				{"15950ce0641",-38.5,-33},
				{"15950ce3dec",-38.5,-33}
			},
			left={
				{"15950f7708e",-38.5,-33},
				{"15950f8610a",-38.5,-33},
				{"15950f94119",-38.5,-33},
				{"15950fa1ec5",-38.5,-33},
				{"15950fa4870",-38.5,-33},
				{"15950fa5da6",-38.5,-33},
				{"15950fa72ac",-38.5,-33},
				{"15950fa87b3",-38.5,-33},
				{"15950fa9ce8",-38.5,-33},
				{"15950f78819",-38.5,-33},
				{"15950f7a684",-38.5,-33},
				{"15950f7bf25",-38.5,-33},
				{"15950f7d357",-38.5,-33},
				{"15950f7e9b4",-38.5,-33},
				{"15950f7fe65",-38.5,-33},
				{"15950f8127c",-38.5,-33},
				{"15950f8285b",-38.5,-33},
				{"15950f83b77",-38.5,-33},
				{"15950f84e14",-38.5,-33},
				{"15950f87403",-38.5,-33},
				{"15950f886b0",-38.5,-33},
				{"15950f899f6",-38.5,-33},
				{"15950f8ad54",-38.5,-33},
				{"15950f8c120",-38.5,-33},
				{"15950f8d518",-38.5,-33},
				{"15950f8ea02",-38.5,-33},
				{"15950f904fe",-38.5,-33},
				{"15950f9189c",-38.5,-33},
				{"15950f92d23",-38.5,-33},
				{"15950f954ae",-38.5,-33},
				{"15950f96844",-38.5,-33},
				{"15950f97b5d",-38.5,-33},
				{"15950f98e47",-38.5,-33},
				{"15950f9a354",-38.5,-33},
				{"15950f9b6ea",-38.5,-33},
				{"15950f9ce9e",-38.5,-33},
				{"15950f9e16e",-38.5,-33},
				{"15950f9f6df",-38.5,-33},
				{"15950fa0a42",-38.5,-33},
				{"15950fa32db",-38.5,-33}
			}
		},
		walking={
			right={
				{"15950a1eae0",-38.5,-33},
				{"15950a2054f",-38.5,-33},
				{"15950a222ba",-38.5,-33},
				{"15950a23a9e",-38.5,-33},
				{"15950a252fc",-38.5,-33},
				{"15950a269de",-38.5,-33},
				{"15950a283bc",-38.5,-33},
				{"15950a29a8e",-38.5,-33},
				{"15950a2b3ba",-38.5,-33}
			},
			left={
				{"15950aa9c5d",-38.5,-33},
				{"15950aab01c",-38.5,-33},
				{"15950aac49f",-38.5,-33},
				{"15950aadd20",-38.5,-33},
				{"15950aaf349",-38.5,-33},
				{"15950ab0b87",-38.5,-33},
				{"15950ab20be",-38.5,-33},
				{"15950ab375a",-38.5,-33},
				{"15950ab53bf",-38.5,-33}
			}
		}
	},
	cat={
		normal={
			right={
				{"156ae5efc27",-22,-48.5},
				{"156ae5f7c0c",-22,-48.5},
				{"156ae5fbd13",-22,-48.5},
				{"156ae602c90",-22,-48.5},
				{"156ae60659a",-22,-48.5},
				{"156ae609050",-22,-48.5},
				{"156ae62ae47",-22,-48.5},
				{"156ae60cac3",-22,-48.5},
				{"156ae61029c",-22,-48.5},
				{"156ae613add",-22,-48.5},
				{"156ae627b0f",-22,-48.5},
				{"156ae62ae47",-22,-48.5},
				{"156ae62ae47",-22,-48.5},
				{"156ae627b0f",-22,-48.5},
				{"156ae613add",-22,-48.5},
				{"156ae61029c",-22,-48.5},
				{"156ae60cac3",-22,-48.5},
				{"156ae62ae47",-22,-48.5},
				{"156ae609050",-22,-48.5},
				{"156ae60659a",-22,-48.5},
				{"156ae602c90",-22,-48.5},
				{"156ae5fbd13",-22,-48.5},
				{"156ae5f7c0c",-22,-48.5},
				{"156ae5efc27",-22,-48.5}
			},
			left={
				{"156ae5bc729",-22,-48.5},
				{"156ae5c043c",-22,-48.5},
				{"156ae5c4729",-22,-48.5},
				{"156ae5c88da",-22,-48.5},
				{"156ae5cbbec",-22,-48.5},
				{"156ae5cf94c",-22,-48.5},
				{"156ae5d3397",-22,-48.5},
				{"156ae5d64ac",-22,-48.5},
				{"156ae5d9042",-22,-48.5},
				{"156ae5dc52b",-22,-48.5},
				{"156ae5def97",-22,-48.5},
				{"156ae5e26d1",-22,-48.5},
				{"156ae5e26d1",-22,-48.5},
				{"156ae5def97",-22,-48.5},
				{"156ae5dc52b",-22,-48.5},
				{"156ae5d9042",-22,-48.5},
				{"156ae5d64ac",-22,-48.5},
				{"156ae5d3397",-22,-48.5},
				{"156ae5cf94c",-22,-48.5},
				{"156ae5cbbec",-22,-48.5},
				{"156ae5c88da",-22,-48.5},
				{"156ae5c4729",-22,-48.5},
				{"156ae5c043c",-22,-48.5},
				{"156ae5bc729",-22,-48.5}
			}
		},
		walking={
			right={
				{"156ae48afdd",-45.5,-48.5},
				{"156ae48f084",-45.5,-48.5},
				{"156ae492919",-45.5,-48.5},
				{"156ae49781e",-45.5,-48.5},
				{"156ae49adf3",-45.5,-48.5},
				{"156ae49dcb1",-45.5,-48.5},
				{"156ae4a1554",-45.5,-48.5},
				{"156ae4b4dd5",-45.5,-48.5},
				{"156ae4b87b9",-45.5,-48.5},
				{"156ae4b87b9",-45.5,-48.5},
				{"156ae4be84e",-45.5,-48.5},
				{"156ae4d0d97",-45.5,-48.5}
			},
			left={
				{"156ae4ff2ef",-45.5,-48.5},
				{"156ae50263c",-45.5,-48.5},
				{"156ae505f33",-45.5,-48.5},
				{"156ae5093ab",-45.5,-48.5},
				{"156ae50c83f",-45.5,-48.5},
				{"156ae51045f",-45.5,-48.5},
				{"156ae514d86",-45.5,-48.5},
				{"156ae519cb2",-45.5,-48.5},
				{"156ae519cb2",-45.5,-48.5},
				{"156ae5239e2",-45.5,-48.5},
				{"156ae52003a",-45.5,-48.5},
				{"156ae5239e2",-45.5,-48.5}
			}
		}
	},
	mouse={
		normal={
			right={
				{"159a71ce8ba",-21.5,-30},
				{"159a71db7c2",-21.5,-30},
				{"159a71e7b34",-21.5,-30},
				{"159a71ee3eb",-21.5,-30},
				{"159a71f024d",-21.5,-30},
				{"159a71f137a",-21.5,-30},
				{"159a71f24cf",-21.5,-30},
				{"159a71f374a",-21.5,-30},
				{"159a71f4940",-21.5,-30},
				{"159a71cfb09",-21.5,-30},
				{"159a71d0cdd",-21.5,-30},
				{"159a71d1ec5",-21.5,-30},
				{"159a71d30c6",-21.5,-30},
				{"159a71d42b4",-21.5,-30},
				{"159a71d53f3",-21.5,-30},
				{"159a71d65b6",-21.5,-30},
				{"159a71d7983",-21.5,-30},
				{"159a71d8cd7",-21.5,-30},
				{"159a71da69d",-21.5,-30},
				{"159a71dc921",-21.5,-30},
				{"159a71dda59",-21.5,-30},
				{"159a71ded67",-21.5,-30},
				{"159a71dff46",-21.5,-30},
				{"159a71e1071",-21.5,-30},
				{"159a71e2308",-21.5,-30},
				{"159a71e3432",-21.5,-30},
				{"159a71e459e",-21.5,-30},
				{"159a71e5744",-21.5,-30},
				{"159a71e68c3",-21.5,-30},
				{"159a71e8c83",-21.5,-30},
				{"159a71e9e8c",-21.5,-30},
				{"159a71eafd1",-21.5,-30},
				{"159a71ec172",-21.5,-30},
				{"159a71ed293",-21.5,-30}
			},
			left={
				{"159a7237eed",-21.5,-30},
				{"159a72442c6",-21.5,-30},
				{"159a7250724",-21.5,-30},
				{"159a7257447",-21.5,-30},
				{"159a7258621",-21.5,-30},
				{"159a7259938",-21.5,-30},
				{"159a725ab63",-21.5,-30},
				{"159a725bf16",-21.5,-30},
				{"159a725d3d0",-21.5,-30},
				{"159a72390e2",-21.5,-30},
				{"159a723a37a",-21.5,-30},
				{"159a723b4b9",-21.5,-30},
				{"159a723c5eb",-21.5,-30},
				{"159a723d743",-21.5,-30},
				{"159a723e8f1",-21.5,-30},
				{"159a723fab7",-21.5,-30},
				{"159a7240cb9",-21.5,-30},
				{"159a7241f43",-21.5,-30},
				{"159a72430a9",-21.5,-30},
				{"159a724549a",-21.5,-30},
				{"159a7246721",-21.5,-30},
				{"159a72478e7",-21.5,-30},
				{"159a7248a9a",-21.5,-30},
				{"159a7249c16",-21.5,-30},
				{"159a724ae04",-21.5,-30},
				{"159a724bfc4",-21.5,-30},
				{"159a724d231",-21.5,-30},
				{"159a724e3af",-21.5,-30},
				{"159a724f539",-21.5,-30},
				{"159a7251b4b",-21.5,-30},
				{"159a7252c7a",-21.5,-30},
				{"159a7253e50",-21.5,-30},
				{"159a7255006",-21.5,-30},
				{"159a725621b",-21.5,-30}
			}
		},
		walking={
			right={
				{"159a731316a",-41,-40},
				{"159a731673a",-41,-40},
				{"159a731788e",-41,-40},
				{"159a7318a17",-41,-40},
				{"159a7319ba2",-41,-40},
				{"159a731ad9c",-41,-40},
				{"159a731beff",-41,-40},
				{"159a731d08c",-41,-40},
				{"159a731e234",-41,-40},
				{"159a7314373",-41,-40},
				{"159a731557a",-41,-40}
			},
			left={
			    {"159a72d2ebe",-41,-40},
			    {"159a72d7791",-41,-40},
			    {"159a72daec0",-41,-40},
			    {"159a72dd255",-41,-40},
			    {"159a72df724",-41,-40},
			    {"159a72e0f54",-41,-40},
			    {"159a72e3406",-41,-40},
			    {"159a72e5837",-41,-40},
			    {"159a72e707e",-41,-40},
			    {"159a72d4718",-41,-40},
			    {"159a72d5fdc",-41,-40}
			}
		}
	}
}

function table.count(tbl)
    local out = 0
    for k in next, tbl do
        out = out + 1
    end
    return out
end

function table.random(list)
	return list[math.random(#list)]
end

function table.indexes(list)
    local out = {}
    for index in next, list do
        out[#out + 1] = index
    end
    return out
end

function eventNewPlayer(n)
	p[n]={image=table.random(table.indexes(images)),state="normal",id=0,right=true}
	system.bindKeyboard(n,32,true)
end
table.foreach(tfm.get.room.playerList,eventNewPlayer)

function eventNewGame()
	for n in pairs(tfm.get.room.playerList) do
		p[n].state="normal"
		p[n].right=true
	end
end

function eventKeyboard(n,k,d,x,y)
	if p[n].image=="wizard" then
		tfm.exec.movePlayer(n,0,0,false,0,-40,false)
	end
end

local c={"cat","wizard","mouse"}
function eventChatCommand(n,cmd)
	for i in pairs(images) do
		if cmd:lower()==i then
			p[n].image=i
		end
	end
end

for i=1,#c do
	system.disableChatCommandDisplay(c[i],true)
end

for t=0, 966.7, 33.3 do
	system.newTimer(function()
		for n in pairs(tfm.get.room.playerList) do
			if tfm.get.room.playerList[n].isJumping or tfm.get.room.playerList[n].movingRight or tfm.get.room.playerList[n].movingLeft then
				p[n].state="walking"
			else
				p[n].state="normal"
			end
			if tfm.get.room.playerList[n].movingRight or tfm.get.room.playerList[n].isFacingRight then
				p[n].right=true
			elseif tfm.get.room.playerList[n].movingLeft or not tfm.get.room.playerList[n].isFacingRight then
				p[n].right=false
			end
			p[n].id=p[n].id+1 > table.count(images[p[n].image][p[n].state].right) and 1 or (p[n].id+1)
			if img[n] then
				tfm.exec.removeImage(img[n])
				img[n]=nil
			end
			img[n]=tfm.exec.addImage(images[p[n].image][p[n].state][p[n].right and "right" or "left"][p[n].id][1]..".png","%"..n,images[p[n].image][p[n].state][p[n].right and "right" or "left"][p[n].id][2], images[p[n].image][p[n].state][p[n].right and "right" or "left"][p[n].id][3])
		end
	end,1000+t,true)
end
tfm.exec.newGame()
